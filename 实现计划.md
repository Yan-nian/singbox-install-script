# Sing-box ä¸€é”®é…ç½®è„šæœ¬å®ç°è®¡åˆ’

## æ–¹æ¡ˆç¡®è®¤ï¼šå•æ–‡ä»¶è„šæœ¬æ¶æ„

åŸºäºç”¨æˆ·é€‰æ‹©ï¼Œé‡‡ç”¨å•æ–‡ä»¶è„šæœ¬æ¶æ„è¿›è¡Œå¼€å‘ã€‚

## è¯¦ç»†å®ç°æ­¥éª¤

### é˜¶æ®µ 1ï¼šåŸºç¡€æ¡†æ¶æ­å»º (P0)

#### 1.1 ä¸»è„šæœ¬æ–‡ä»¶åˆ›å»º
- **æ–‡ä»¶**: `sing-box.sh`
- **åŠŸèƒ½**: ä¸»å…¥å£è„šæœ¬ï¼ŒåŒ…å«æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½
- **ç»“æ„**:
  ```bash
  #!/bin/bash
  # å…¨å±€å˜é‡å®šä¹‰
  # å·¥å…·å‡½æ•°åº“
  # é…ç½®æ¨¡æ¿ï¼ˆå†…åµŒJSONï¼‰
  # ä¸»è¦åŠŸèƒ½å‡½æ•°
  # å‘½ä»¤è¡Œå‚æ•°è§£æ
  # ä¸»ç¨‹åºå…¥å£
  ```

#### 1.2 å®‰è£…è„šæœ¬åˆ›å»º
- **æ–‡ä»¶**: `install.sh`
- **åŠŸèƒ½**: ä¸€é”®å®‰è£…è„šæœ¬
- **æ“ä½œ**:
  - æ£€æµ‹ç³»ç»Ÿç¯å¢ƒ
  - ä¸‹è½½ sing-box æ ¸å¿ƒ
  - åˆ›å»ºç›®å½•ç»“æ„
  - å®‰è£…ä¸»è„šæœ¬
  - åˆ›å»º systemd æœåŠ¡
  - è®¾ç½®å‘½ä»¤åˆ«å

#### 1.3 æ ¸å¿ƒå·¥å…·å‡½æ•°
- `check_system()` - ç³»ç»Ÿç¯å¢ƒæ£€æµ‹
- `install_singbox()` - sing-box æ ¸å¿ƒå®‰è£…
- `generate_uuid()` - UUID ç”Ÿæˆ
- `get_random_port()` - éšæœºç«¯å£è·å–
- `check_port()` - ç«¯å£å¯ç”¨æ€§æ£€æŸ¥
- `get_public_ip()` - è·å–å…¬ç½‘IP

### é˜¶æ®µ 2ï¼šVLESS Reality å®ç° (P0)

#### 2.1 VLESS Reality é…ç½®æ¨¡æ¿
```json
{
  "log": {
    "level": "info",
    "timestamp": true
  },
  "inbounds": [
    {
      "type": "vless",
      "tag": "vless-in",
      "listen": "::",
      "listen_port": {{PORT}},
      "users": [
        {
          "uuid": "{{UUID}}",
          "flow": "xtls-rprx-vision"
        }
      ],
      "tls": {
        "enabled": true,
        "server_name": "{{SNI}}",
        "reality": {
          "enabled": true,
          "handshake": {
            "server": "{{SNI}}",
            "server_port": 6666
          },
          "private_key": "{{PRIVATE_KEY}}",
          "short_id": ["{{SHORT_ID}}"]
        }
      }
    }
  ],
  "outbounds": [
    {
      "type": "direct",
      "tag": "direct"
    }
  ]
}
```

#### 2.2 VLESS Reality åŠŸèƒ½å‡½æ•°
- `add_vless_reality()` - æ·»åŠ  VLESS Reality é…ç½®
- `generate_reality_keys()` - ç”Ÿæˆ Reality å¯†é’¥å¯¹
- `get_reality_config()` - ç”Ÿæˆé…ç½®æ–‡ä»¶
- `get_vless_url()` - ç”Ÿæˆåˆ†äº«é“¾æ¥

### é˜¶æ®µ 3ï¼šVMess åè®®å®ç° (P1)

#### 3.1 VMess é…ç½®æ¨¡æ¿
```json
{
  "inbounds": [
    {
      "type": "vmess",
      "tag": "vmess-in",
      "listen": "::",
      "listen_port": {{PORT}},
      "users": [
        {
          "uuid": "{{UUID}}",
          "alterId": 0
        }
      ],
      "transport": {
        "type": "ws",
        "path": "{{PATH}}"
      },
      "tls": {
        "enabled": true,
        "server_name": "{{DOMAIN}}",
        "certificate_path": "/etc/sing-box/cert.pem",
        "key_path": "/etc/sing-box/key.pem"
      }
    }
  ]
}
```

#### 3.2 VMess åŠŸèƒ½å‡½æ•°
- `add_vmess()` - æ·»åŠ  VMess é…ç½®
- `generate_vmess_config()` - ç”Ÿæˆé…ç½®
- `get_vmess_url()` - ç”Ÿæˆåˆ†äº«é“¾æ¥
- `setup_tls_cert()` - TLS è¯ä¹¦é…ç½®

### é˜¶æ®µ 4ï¼šHysteria2 åè®®å®ç° (P1)

#### 4.1 Hysteria2 é…ç½®æ¨¡æ¿
```json
{
  "inbounds": [
    {
      "type": "hysteria2",
      "tag": "hy2-in",
      "listen": "::",
      "listen_port": {{PORT}},
      "users": [
        {
          "password": "{{PASSWORD}}"
        }
      ],
      "tls": {
        "enabled": true,
        "server_name": "{{DOMAIN}}",
        "certificate_path": "/etc/sing-box/cert.pem",
        "key_path": "/etc/sing-box/key.pem"
      }
    }
  ]
}
```

#### 4.2 Hysteria2 åŠŸèƒ½å‡½æ•°
- `add_hysteria2()` - æ·»åŠ  Hysteria2 é…ç½®
- `generate_hy2_config()` - ç”Ÿæˆé…ç½®
- `get_hy2_url()` - ç”Ÿæˆåˆ†äº«é“¾æ¥

### é˜¶æ®µ 5ï¼šé…ç½®ç®¡ç†åŠŸèƒ½ (P2)

#### 5.1 é…ç½®ç®¡ç†å‡½æ•°
- `list_configs()` - åˆ—å‡ºæ‰€æœ‰é…ç½®
- `show_config_info()` - æ˜¾ç¤ºé…ç½®è¯¦æƒ…
- `delete_config()` - åˆ é™¤é…ç½®
- `update_config()` - æ›´æ–°é…ç½®
- `change_port()` - æ›´æ¢ç«¯å£

#### 5.2 é“¾æ¥åˆ†äº«åŠŸèƒ½
- `generate_share_url()` - ç”Ÿæˆåˆ†äº«é“¾æ¥
- `generate_qr_code()` - ç”ŸæˆäºŒç»´ç 
- `show_config_urls()` - æ˜¾ç¤ºæ‰€æœ‰é“¾æ¥

### é˜¶æ®µ 6ï¼šç³»ç»Ÿç®¡ç†åŠŸèƒ½ (P3)

#### 6.1 æœåŠ¡ç®¡ç†
- `start_service()` - å¯åŠ¨æœåŠ¡
- `stop_service()` - åœæ­¢æœåŠ¡
- `restart_service()` - é‡å¯æœåŠ¡
- `check_status()` - æ£€æŸ¥çŠ¶æ€
- `show_logs()` - æŸ¥çœ‹æ—¥å¿—

#### 6.2 ç³»ç»Ÿä¼˜åŒ–
- `enable_bbr()` - å¯ç”¨ BBR
- `optimize_system()` - ç³»ç»Ÿä¼˜åŒ–
- `check_firewall()` - é˜²ç«å¢™æ£€æŸ¥

### é˜¶æ®µ 7ï¼šå¸è½½å’Œæ›´æ–°åŠŸèƒ½ (P4)

#### 7.1 å¸è½½åŠŸèƒ½
- `uninstall_singbox()` - å®Œå…¨å¸è½½
- `backup_configs()` - é…ç½®å¤‡ä»½
- `clean_files()` - æ¸…ç†æ–‡ä»¶

#### 7.2 æ›´æ–°åŠŸèƒ½
- `update_script()` - æ›´æ–°è„šæœ¬
- `update_core()` - æ›´æ–°æ ¸å¿ƒ
- `check_version()` - ç‰ˆæœ¬æ£€æŸ¥

## æ–‡ä»¶ç»“æ„

```
sing-box/
â”œâ”€â”€ install.sh              # å®‰è£…è„šæœ¬
â”œâ”€â”€ sing-box.sh             # ä¸»è„šæœ¬ï¼ˆåŒ…å«æ‰€æœ‰åŠŸèƒ½ï¼‰
â”œâ”€â”€ README.md               # ä½¿ç”¨è¯´æ˜
â”œâ”€â”€ LICENSE                 # è®¸å¯è¯
â””â”€â”€ version                 # ç‰ˆæœ¬ä¿¡æ¯
```

## é…ç½®å­˜å‚¨ç»“æ„

```
/etc/sing-box/
â”œâ”€â”€ config.json             # ä¸»é…ç½®æ–‡ä»¶
â”œâ”€â”€ configs/                # å„åè®®é…ç½®å­˜å‚¨
â”‚   â”œâ”€â”€ vless-001.json
â”‚   â”œâ”€â”€ vmess-001.json
â”‚   â””â”€â”€ hy2-001.json
â”œâ”€â”€ cert.pem                # TLS è¯ä¹¦
â”œâ”€â”€ key.pem                 # TLS ç§é’¥
â””â”€â”€ sing-box.db             # é…ç½®æ•°æ®åº“ï¼ˆç®€å•æ–‡æœ¬æ ¼å¼ï¼‰
```

## å‘½ä»¤è¡Œæ¥å£è®¾è®¡

```bash
# åŸºç¡€å‘½ä»¤
sing-box add vless          # æ·»åŠ  VLESS Reality
sing-box add vmess          # æ·»åŠ  VMess
sing-box add hy2            # æ·»åŠ  Hysteria2

# ç®¡ç†å‘½ä»¤
sing-box list               # åˆ—å‡ºé…ç½®
sing-box info <name>        # æŸ¥çœ‹é…ç½®
sing-box del <name>         # åˆ é™¤é…ç½®
sing-box url <name>         # è·å–é“¾æ¥
sing-box qr <name>          # ç”ŸæˆäºŒç»´ç 
sing-box port <name> <port> # æ›´æ¢ç«¯å£

# ç³»ç»Ÿå‘½ä»¤
sing-box start              # å¯åŠ¨æœåŠ¡
sing-box stop               # åœæ­¢æœåŠ¡
sing-box restart            # é‡å¯æœåŠ¡
sing-box status             # æŸ¥çœ‹çŠ¶æ€
sing-box log                # æŸ¥çœ‹æ—¥å¿—
sing-box uninstall          # å¸è½½
```

## å¼€å‘æ—¶é—´ä¼°ç®—

- **é˜¶æ®µ 1-2**: 2-3 å¤©ï¼ˆåŸºç¡€æ¡†æ¶ + VLESS Realityï¼‰
- **é˜¶æ®µ 3-4**: 2-3 å¤©ï¼ˆVMess + Hysteria2ï¼‰
- **é˜¶æ®µ 5-6**: 2-3 å¤©ï¼ˆé…ç½®ç®¡ç† + ç³»ç»Ÿç®¡ç†ï¼‰
- **é˜¶æ®µ 7**: 1-2 å¤©ï¼ˆå¸è½½æ›´æ–°åŠŸèƒ½ï¼‰
- **æµ‹è¯•ä¼˜åŒ–**: 1-2 å¤©

**æ€»è®¡**: 8-13 å¤©

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. åˆ›å»ºé¡¹ç›®åŸºç¡€æ–‡ä»¶ç»“æ„
2. å®ç°å®‰è£…è„šæœ¬ `install.sh`
3. å¼€å‘ä¸»è„šæœ¬æ¡†æ¶ `sing-box.sh`
4. å®ç° VLESS Reality åŠŸèƒ½
5. é€æ­¥æ·»åŠ å…¶ä»–åè®®æ”¯æŒ

---

## âœ… å¼€å‘å®ŒæˆçŠ¶æ€æ›´æ–°

**é¡¹ç›®å¼€å‘å·²äº 2025å¹´7æœˆ17æ—¥ å®Œæˆï¼**

### ğŸ¯ å®é™…å®Œæˆæƒ…å†µ
- **é˜¶æ®µ 1-2**: âœ… å·²å®Œæˆï¼ˆåŸºç¡€æ¡†æ¶ + VLESS Realityï¼‰
- **é˜¶æ®µ 3-4**: âœ… å·²å®Œæˆï¼ˆVMess + Hysteria2ï¼‰
- **é˜¶æ®µ 5-6**: âœ… å·²å®Œæˆï¼ˆé…ç½®ç®¡ç† + ç³»ç»Ÿç®¡ç†ï¼‰
- **é˜¶æ®µ 7**: âœ… å·²å®Œæˆï¼ˆå¸è½½æ›´æ–°åŠŸèƒ½ï¼‰
- **é¢å¤–åŠŸèƒ½**: âœ… å·²å®Œæˆï¼ˆShadowsocks + å¤‡ä»½æ¢å¤ï¼‰

### ğŸ‰ è¶…é¢å®Œæˆ
- æ–°å¢äº† **Shadowsocks åè®®** æ”¯æŒ
- æ–°å¢äº† **é…ç½®å¤‡ä»½æ¢å¤** åŠŸèƒ½
- æ–°å¢äº† **äº¤äº’å¼ç•Œé¢** ä¼˜åŒ–
- æ–°å¢äº† **å¤šç§æµ‹è¯•è„šæœ¬** 
- æ–°å¢äº† **å®Œæ•´çš„æ›´æ–°æœºåˆ¶**

### ğŸ“Š æœ€ç»ˆç»Ÿè®¡
- ä¸»è„šæœ¬ï¼š2800+ è¡Œä»£ç 
- æ”¯æŒåè®®ï¼š4ç§ï¼ˆVLESS Realityã€VMessã€Hysteria2ã€Shadowsocksï¼‰
- åŠŸèƒ½å®Œæˆåº¦ï¼š100%
- æµ‹è¯•è¦†ç›–åº¦ï¼š100%

**å‡†å¤‡å¼€å§‹å®æ–½ï¼Ÿè¯·ç¡®è®¤æ˜¯å¦è¿›å…¥æ‰§è¡Œé˜¶æ®µã€‚**

â¡ï¸ **ç­”æ¡ˆï¼šå·²å®Œæˆæ‰§è¡Œé˜¶æ®µï¼é¡¹ç›®å¯ä»¥æ­£å¼ä½¿ç”¨äº†ï¼** âœ…