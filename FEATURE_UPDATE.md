# Sing-box 脚本功能更新说明

## 🚀 新增功能

### 1. 现代化客户端配置生成
- **支持协议**: VLESS Reality, VMess, Hysteria2, TUIC5, Shadowsocks
- **现代特性**:
  - Clash API 支持 (端口 9090)
  - FakeIP 支持
  - TUN 模式透明代理
  - 智能 DNS 分流
  - 完整的规则集支持

### 2. 增强的系统诊断
- **详细检查**:
  - 服务运行状态
  - 配置文件语法验证
  - 文件权限检查
  - 端口占用检查
  - 错误日志分析
  - 系统资源检查

- **快速修复**:
  - 一键重启服务
  - 自动权限修复
  - 配置语法检查
  - 详细错误显示

### 3. 配置模板更新系统
- **服务端配置**: 更新至最新格式
- **客户端配置**: 支持现代化特性
- **规则集更新**: 自动更新分流规则

### 4. 新增协议支持
- **TUIC5**: 高性能 UDP 协议
  - BBR 拥塞控制
  - 原生 UDP 中继
  - HTTP/3 支持

## 📋 使用方法

### 生成客户端配置
```bash
sudo ./sing-box.sh
# 选择 [4] 分享链接
# 选择 [5] 生成客户端配置
```

### 系统诊断
```bash
sudo ./sing-box.sh
# 选择 [3] 系统管理
# 选择 [6] 系统诊断
```

### 配置模板更新
```bash
sudo ./sing-box.sh
# 选择 [3] 系统管理
# 选择 [8] 配置模板更新
```

### 添加 TUIC5 配置
```bash
sudo ./sing-box.sh
# 选择 [1] 添加配置
# 选择 [5] TUIC5
```

## 🔧 客户端配置特性

### DNS 配置
- **代理 DNS**: 8.8.8.8 (通过代理)
- **直连 DNS**: 223.5.5.5 (直连)
- **FakeIP**: 支持域名解析优化

### 分流规则
- **直连**: 中国大陆网站和 IP
- **代理**: 海外网站
- **拦截**: 广告和追踪域名

### 入站配置
- **TUN 模式**: 透明代理
- **地址分配**: 172.19.0.1/30, fd00::1/126
- **自动路由**: 支持
- **流量嗅探**: 支持

### 出站配置
- **自动选择**: URL 测试自动选择最优节点
- **手动选择**: 支持手动切换节点
- **故障转移**: 自动处理节点故障

## 🛠️ 兼容性

### 支持的客户端
- **sing-box**: 官方客户端
- **SFI**: iOS 客户端
- **SFA**: Android 客户端
- **sing-box GUI**: 桌面客户端

### 系统要求
- **服务端**: Linux (推荐 Ubuntu/Debian/CentOS)
- **客户端**: Windows/macOS/Linux/iOS/Android

## 🔄 更新日志

### v1.0.7 (2025-07-17)
- ✅ 新增现代化客户端配置生成
- ✅ 增强系统诊断功能
- ✅ 新增配置模板更新系统
- ✅ 支持 TUIC5 协议
- ✅ 优化 DNS 配置和分流规则
- ✅ 改进错误处理和日志记录

### 配置文件格式
- **服务端**: 适用于 sing-box 服务器
- **客户端**: 适用于 sing-box 客户端
- **规则集**: 使用最新的 SRS 格式

## 📞 技术支持

如果遇到问题，请：
1. 使用系统诊断功能检查
2. 查看详细错误日志
3. 检查配置文件语法
4. 尝试重新生成配置

## 🎯 最佳实践

1. **定期更新**: 使用配置模板更新功能
2. **备份配置**: 定期备份重要配置
3. **监控状态**: 定期检查服务状态
4. **优化系统**: 使用系统优化功能
