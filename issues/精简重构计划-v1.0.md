# Sing-box 精简重构计划 v1.0

## 项目目标
基于用户需求，将现有企业级复杂架构重构为精简实用版本，保留核心功能，去除不必要的复杂度。

## 核心原则
- **简单优先**：功能实用，架构清晰
- **易于维护**：代码简洁，逻辑明确
- **快速部署**：一键安装，即用即走
- **稳定可靠**：基于官方标准配置

## 新架构设计

### 文件结构
```
singbox/
├── install.sh              # 主安装脚本
├── scripts/
│   ├── protocols/
│   │   ├── vless-reality.sh # VLESS Reality 配置
│   │   ├── vmess-ws.sh      # VMess WebSocket 配置
│   │   └── hysteria2.sh     # Hysteria2 配置
│   ├── common.sh            # 通用函数库
│   ├── menu.sh              # 交互菜单
│   └── subscription.sh      # 订阅链接生成
├── templates/
│   ├── vless-reality.json   # VLESS Reality 模板
│   ├── vmess-ws.json        # VMess WebSocket 模板
│   └── hysteria2.json       # Hysteria2 模板
├── README.md
├── VERSION
└── LICENSE
```

### 核心模块

#### 1. 主安装脚本 (install.sh)
- 系统环境检测
- Sing-box 安装
- 协议选择菜单
- 服务管理

#### 2. 协议配置模块
- **VLESS Reality**: 基于官方标准，支持 XTLS-RPRX-Vision
- **VMess WebSocket**: 支持 TLS 加密，兼容性好
- **Hysteria2**: 基于 QUIC，高性能传输

#### 3. 配置模板
- 基于 sing-box 官方文档标准
- 预设安全参数
- 支持自定义端口和域名

#### 4. 订阅系统
- 生成标准分享链接
- 支持二维码生成
- 批量导出功能

## 实施计划

### 阶段一：清理与重构 (1-2天)
1. 备份现有项目
2. 清理复杂架构文件
3. 创建新的简化目录结构
4. 迁移有用的配置模板

### 阶段二：核心开发 (2-3天)
1. 开发主安装脚本
2. 实现协议配置模块
3. 创建标准配置模板
4. 开发交互菜单系统

### 阶段三：功能完善 (1-2天)
1. 实现订阅链接生成
2. 添加二维码支持
3. 完善服务管理功能
4. 错误处理和日志

### 阶段四：测试与优化 (1天)
1. 功能测试
2. 兼容性测试
3. 性能优化
4. 文档更新

## 技术规范

### 代码标准
- Bash 脚本，兼容主流 Linux 发行版
- 函数化编程，模块清晰
- 统一错误处理
- 详细注释说明

### 配置标准
- 基于 sing-box 官方 JSON 格式
- 安全的默认参数
- 支持用户自定义
- 配置验证机制

### 安全考虑
- 随机生成 UUID 和密钥
- 安全的端口选择
- TLS 证书自动申请
- 防火墙自动配置

## 预期成果

### 用户体验
- 一条命令完成安装
- 图形化菜单操作
- 自动生成分享链接
- 支持多种客户端

### 维护性
- 代码量减少 70%
- 模块化设计
- 易于扩展
- 简化调试

### 兼容性
- 支持 Ubuntu/Debian/CentOS
- 兼容主流客户端
- 支持 IPv4/IPv6
- 适配不同网络环境

## 成功指标
- 安装成功率 > 95%
- 配置生成无错误
- 客户端连接成功
- 用户反馈积极

---

**开始时间**: 2024年12月
**预计完成**: 1周内
**负责人**: AI Assistant
**状态**: 计划阶段